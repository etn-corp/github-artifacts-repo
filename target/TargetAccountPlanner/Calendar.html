<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="keywords" CONTENT="javascript, calendar, monthly calendar">
   <META NAME="description" CONTENT="Monthly calendar that highlights current date">
   <META NAME="Distribution" CONTENT="GLOBAL">
   <TITLE>Calendar</TITLE>
<SCRIPT LANGUAGE="JavaScript">
<!--
function displayCalendar(init)
{
   var i;
   var now = new Date();
   // This is a hack. This might not work in the future.
   // The problem is due to the JavaScript version, I think.
   if (navigator.appName=="Microsoft Internet Explorer")
     var nowYear = now.getYear() - 2000;
   else
     var nowYear = now.getYear() - 100;

   var nowMonth = now.getMonth();
   var nowDay   = now.getDate();

   // on open of document
   if (init == 1)
   {
     document.calControl.month.selectedIndex = nowMonth;
     document.calControl.year.selectedIndex = nowYear;
   }
   var month=document.calControl.month.selectedIndex;
   var year=document.calControl.year.selectedIndex+2000;

   var days=getDaysInMonth(month+1,year);

   var firstOfMonth = new Date (year, month, 1);

   var startingPos=firstOfMonth.getDay();

   days += startingPos;

   // blank out non date buttons
   for (i=0; i<startingPos; i++)
     document.calButtons.elements[i].value = "    ";

   for (i=startingPos; i<days; i++)
     document.calButtons.elements[i].value =  ((i-startingPos+1 > 9) ? "" : "  ") + (i-startingPos+1);

   // show focus on today if the calendar is the proper month and year
   if (month==nowMonth && year==nowYear+2000)
     document.calButtons.elements[nowDay+startingPos-1].focus();

   // blank out rest of non date buttons
  for (i=days; i<document.calButtons.elements.length; i++)
     document.calButtons.elements[i].value = "    ";
}

function leapYear (Year)
{
  if (((Year % 4) == 0)
  && ((Year % 100) != 0)
      || ((Year % 400) == 0))
    return (1);
  else
    return (0);
}

function getDaysInMonth(month,year)
{
   var days = 31;
   if (month==4 || month==6 || month==9 || month==11)
       days = 30;
   else if (month == 2)
   {
      if (leapYear (year) == 1)
	    days=29;
      else
	    days=28;
   }
  return (days);
}

function setDate (field)
{
	var day = parseInt(field.value, 10);

	if(!isNaN (field.value) && (field.value >= 1))
	{
		field.value = (day < 10) ? ("0" + day) : day;
		window.opener.document.SALESPLAN.elements[window.opener.document.SALESPLAN.DATE_FIELD_NAME.value].value = document.calControl.month.options[document.calControl.month.selectedIndex].value + "/" + field.value + "/" + document.calControl.year.options[document.calControl.year.selectedIndex].value;
	}
	else
		window.opener.document.SALESPLAN.elements[window.opener.document.SALESPLAN.DATE_FIELD_NAME.value].value = "";
	window.close();
}
// -->


</SCRIPT>
</HEAD>
<BODY BGCOLOR="#FFFFFF" onLoad="displayCalendar(1)">
<FORM NAME="calControl">
<SELECT NAME="month" onChange="displayCalendar(0)">
<OPTION VALUE='01'>Jan
<OPTION VALUE='02'>Feb
<OPTION VALUE='03'>Mar
<OPTION VALUE='04'>Apr
<OPTION VALUE='05'>May
<OPTION VALUE='06'>Jun
<OPTION VALUE='07'>Jul
<OPTION VALUE='08'>Aug
<OPTION VALUE='09'>Sep
<OPTION VALUE='10'>Oct
<OPTION VALUE='11'>Nov
<OPTION VALUE='12'>Dec
</SELECT>
<SELECT NAME="year" onChange="displayCalendar(0)">
<OPTION VALUE=2000>2000
<OPTION VALUE=2001>2001
<OPTION VALUE=2002>2002
<OPTION VALUE=2003>2003
<OPTION VALUE=2004>2004
<OPTION VALUE=2005>2005
<OPTION VALUE=2006>2006
<OPTION VALUE=2007>2007
</SELECT>
</FORM>
<TABLE BORDER='1' CELLSPACING='0' CELLPADDING='0'>
    <FORM NAME="calButtons">
        <TR>
            <TD CLASS="title" ALIGN="CENTER" BGCOLOR="#CCCCCC"> S </TD>
            <TD CLASS="title" ALIGN="CENTER" BGCOLOR="#CCCCCC"> M </TD>
            <TD CLASS="title" ALIGN="CENTER" BGCOLOR="#CCCCCC"> T </TD>
            <TD CLASS="title" ALIGN="CENTER" BGCOLOR="#CCCCCC"> W </TD>
            <TD CLASS="title" ALIGN="CENTER" BGCOLOR="#CCCCCC"> T </TD>
            <TD CLASS="title" ALIGN="CENTER" BGCOLOR="#CCCCCC"> F </TD>
            <TD CLASS="title" ALIGN="CENTER" BGCOLOR="#CCCCCC"> S </TD>
        </TR>
        <TR>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but7"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but8"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but9"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but10"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but11"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but12"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but13"  VALUE="     " onClick="setDate(this)">
            </TD>
        <TR>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but14"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but15"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but16"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but17"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but18"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but19"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but20"  VALUE="     " onClick="setDate(this)">
            </TD>
        <TR>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but21"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but22"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but23"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but24"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but25"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but26"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but27"  VALUE="     " onClick="setDate(this)">
            </TD>
        <TR>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but28"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but29"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but30"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but31"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but32"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but33"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but34"  VALUE="     " onClick="setDate(this)">
            </TD>
        <TR>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but35"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but36"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but37"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but38"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but39"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but40"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but41"  VALUE="     " onClick="setDate(this)">
            </TD>
        <TR>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but42"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but43"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but44"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but45"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but46"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but47"  VALUE="     " onClick="setDate(this)">
            </TD>
            <TD CLASS="button">
                <INPUT TYPE="button" NAME="but48"  VALUE="     " onClick="setDate(this)">
            </TD>
    </FORM>
</TABLE>
</BODY>
</HTML>


